<!DOCTYPE html>
<html>
  <head>
    <title>View</title>
    <meta content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    
    <link href="../resources/styles/bootstrap.min.css" rel="stylesheet" media="screen">
    <script src="../resources/scripts/bootstrap.min.js"></script>
    <script src="../resources/scripts/jquery.js"></script>
    <script src="../resources/scripts/jquery.loadTemplate-1.3.2.min.js"></script>
    
    
    <style>
    body{
       margin-bottom: 40px;
    }
    </style>
    <script>
    var prmstr = window.location.search.substr(1);
    var prmarr = prmstr.split ("&");
    var params = {};

    for ( var i = 0; i < prmarr.length; i++) {
        var tmparr = prmarr[i].split("=");
        params[tmparr[0]] = tmparr[1];
    }
    
	//alert(params['id']);
	getPosts(params['id'],1);
	
	function getPosts(id,pageNum){
		var url="/SelfCareCommunity/service/thread/"+id+"/posts/page/"+pageNum;

		$.ajax({
			url: url,
			type: "get",
			dataType: "json",
			success: function(result){

			$("#container").html("<div id='postList'></div>");
				data=result.data;
				for(var i=0;i<data.length;i++){
			
					var id=data[i].id;
					var author=data[i].author.name;
					var content=data[i].content;
					var date=data[i].postedDate;
					var likes=data[i].likes;
			
					$("#postList").append("<div id='post"+id+"'></div>");
					$("#post"+id).loadTemplate("template/post.html",
					{
						authorPic: '../resources/img/avatar.png',
						author: author,
						content: content,
						date: date,
						likes: likes+" likes"
					});
			}
			$("#postList").append("<div id='addPost'></div>");
			$("#addPost").loadTemplate("template/addPost.html",{
			threadID: id
			});
			}
			});
	}
  	 </script>

 </head>
 
 <body>
   <div class="navbar">
  	<div class="navbar-inner">
    <a class="brand" href="#">SelfCareCommunity</a>
    <ul class="nav">
      <li class="active"><a href="#">Home</a></li>
      <li><a href="#">Link</a></li>
      <li><a href="#">Link</a></li>
    </ul>
  </div>
</div>




<div id="container" class="span9 offset3">
	
</div>



 </body>
</html>